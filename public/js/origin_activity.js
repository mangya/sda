$(document).ready(function(){var t=1;function e(t){var e=function(){var t={},e={},i=$("body").find('[name="owner"]').val(),a=$("body").find('[name="action"]').val(),o=$("body").find('[name="module"]').val();(i||a||o)&&(i&&(e.owner=i),a&&(e.action=a),o&&(e.module=o),t.filters=e);return t}();$(".data-loader").show(),$.ajax({type:"GET",url:app_route+"?page="+t,data:e,dataType:"json",success:function(t){var e=t.activities.data,i=t.current_user,a=(t.activities.from,"");$("body").find(".no-data").remove(),e.length>0?($.each(e,function(t,e){var o=!1,n="<strong>"+(i.id==e.user_id?"You":e.user)+"</strong>",r=moment(e.created_at).fromNow(),d=moment(e.created_at).format("MMM D, YYYY on hh:mm A");if("Create"==e.action)var s="bg-blue";else if("Update"==e.action)s="bg-yellow";else if("Delete"==e.action)s="bg-red";else s="bg-aqua";if("Auth"==e.module)o="Login"==e.action?n+" logged in":n+" logged out";else{if(e.form_id)var c="<strong>"+e.module+": "+e.form_title+"</strong>";"Create"==e.action?o="New "+c+" created by "+n:"Update"==e.action?o=c+" updated by "+n:"Delete"==e.action&&(o="<strong>"+e.module+": "+e.form_title+"</strong>",o+=" deleted by "+n)}a+='<li>\t\t\t\t\t\t\t<i class="'+e.icon+" "+s+'"></i>\t\t\t\t\t\t\t<div class="timeline-item">\t\t\t\t\t\t\t\t<span class="time">\t\t\t\t\t\t\t\t\t<i class="fa fa-clock-o"></i> '+r+'\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t\t<div class="timeline-body no-border">'+o+'<br />\t\t\t\t\t\t\t\t\t<small class="text-muted">'+d+"</small>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>"}),$(".origin-activities").empty().append(a)):(a='<div class="h4 text-center no-data"><strong>No Data</strong></div>',$(".origin-activities").empty(),$(".origin-activities").after(a)),$(".data-loader").hide(),$("#item-count").html(t.activities.total||"0"),$("#item-from").html(t.activities.from||"0"),$("#item-to").html(t.activities.to||"0"),$(".origin-pagination-content").empty().append(makePagination(t.activities))},error:function(t){notify(JSON.parse(t.responseText).message,"error"),$(".data-loader").hide()}})}e(t),$(".refresh-activity").on("click",function(){e(t=1)}),$("body").on("change",".activity-filter",function(i){e(t=1)}),$("body").on("click",".origin-pagination a",function(i){i.preventDefault(),"#"!=$(this).attr("href")&&$(this).attr("href").indexOf("page=")>=0&&e(t=$(this).attr("href").split("page=")[1])}),$(window).on("hashchange",function(){if(window.location.hash){var t=window.location.hash.replace("#","");if(t==Number.NaN||t<=0)return!1;e(t)}})});
